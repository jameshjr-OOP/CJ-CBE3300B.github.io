<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CBE 3300B | Pulseometer</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <link rel="stylesheet" href="style.css">
</head>

<body class="bg-light text-dark"
  style="font-family:'Times New Roman', Times, serif;">

  <!-- Header -->
  <header 
    class="text-center py-5 header-green"
    style="background-color:#e6e6e6; color:black; font-family:'Times New Roman', Times, serif; padding: 0.75rem;"
    >
    <h1>CBE 3300B | Pulseometer</h1>
    <p>Connor Dunne & James Hadley, Jr.</p>

<nav
    style="
    position: sticky;
    top: 0;
    width: 100%;
    background-color: #e6e6e6;
    padding: 0.75rem;
    text-align: center;
    z-index: 1000;
  "
  >
  <a href="#overview" class="btn m-2" style="color:black; border:1px solid black;">
    Overview
  </a>
  <a href="#gantt" class="btn m-2" style="color:black; border:1px solid black;">
    GANTT Chart
  </a>
  <a href="#milestones" class="btn m-2" style="color:black; border:1px solid black;">
    Milestones
  </a>
  <a href="#design" class="btn m-2" style="color:black; border:1px solid black;">
    Design
  </a>
  <a href="#ref" class="btn m-2" style="color:black; border:1px solid black;">
    References
  </a>

</nav>
  </header>

  <!-- Project Overview -->
  <section id="overview" class="container py-5">
    <h2 class="text-primary">Project Overview</h2>
    <p>Write Project Overview Section Here.</p>
  </section>

  <!-- GANTT Chart -->
  <section id="gantt" class="container py-5">
    <h2 class="text-primary">GANTT Chart</h2>
    <p class="text-muted">This table pulls live data from Google Sheets.</p>
  
    <div class="table-responsive">
      <div id="sheet-table">Loadingâ€¦</div>
    </div>
  </section>
  
  <!-- PapaParse (robust CSV parsing) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  
  <script>
    // IMPORTANT: replace with your published-to-web CSV URL
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQnVuBDbJ8Ixsd71iDGYwxxhoGw3gpQd2K_VOAbr6QpohzsvL9PAMZ1Zct25yvzZSLp4ARQXlTTmTS2/pub?gid=0&single=true&output=csv";
  
    // refresh every 60 seconds
    const REFRESH_MS = 60_000;
  
    function renderTable(rows) {
      if (!rows || rows.length === 0) {
        document.getElementById("sheet-table").textContent = "No data found.";
        return;
      }
  
      const table = document.createElement("table");
      table.className = "table table-bordered table-sm align-middle";
      table.style.width = "100%";
  
      rows.forEach((row, rIdx) => {
        const tr = document.createElement("tr");
  
        row.forEach((cell) => {
          const el = document.createElement(rIdx === 0 ? "th" : "td");
          el.textContent = (cell ?? "").toString();
          tr.appendChild(el);
        });
  
        table.appendChild(tr);
      });
  
      const container = document.getElementById("sheet-table");
      container.innerHTML = "";
      container.appendChild(table);
    }
  
    async function loadSheet() {
      const res = await fetch(CSV_URL, { cache: "no-store" });
      if (!res.ok) throw new Error("Failed to fetch CSV");
  
      const csvText = await res.text();
  
      const parsed = Papa.parse(csvText, {
        skipEmptyLines: true
      });
  
      if (parsed.errors && parsed.errors.length) {
        console.warn("CSV parse warnings:", parsed.errors);
      }
  
      renderTable(parsed.data);
    }
  
    async function start() {
      try {
        await loadSheet();
      } catch (e) {
        console.error(e);
        document.getElementById("sheet-table").textContent =
          "Could not load sheet. Check the CSV URL and that the sheet is published.";
      }
  
      setInterval(() => {
        loadSheet().catch(console.error);
      }, REFRESH_MS);
    }
  
    start();
  </script>

  <!-- Project Milestones -->
  <section id="milestones" class="container py-5">
    <h2 class="text-primary">Project Milestones</h2>
    <p>Write Project Milestones Section Here.</p>
    <a href="website/pdr.html" class="btn">Preliminary Design Report</a>
  </section>

  <!-- Design -->
  <section id="design" class="container py-5">
    <h2 class="text-primary">Engineering Design</h2>
    <p>Write Engineering Design Section Here.</p>
  </section>

  <!-- References -->
  <section id="ref" class="container py-5">
    <h2 class="text-primary">References</h2>
    <p>Write References Section Here.</p>
  </section>


</body>
</html>
